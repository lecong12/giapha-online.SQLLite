<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gia Ph·∫£ Online - Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../style/style.css">
</head>
<body class="dashboard-page">
    <!-- HEADER -->
    <header class="header">
        <div class="header-container">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-sitemap"></i>
                </div>
                <div class="header-info">
                    <h1>Gia Ph·∫£ Online</h1>
                    <p class="user-role" id="userRole"></p>
                </div>
            </div>
            <div class="header-right">
                <span class="user-name" id="userName"></span>
                <button class="btn-logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> ƒêƒÉng Xu·∫•t
                </button>
            </div>
        </div>
    </header>

    <!-- TABS -->
    <div class="tabs-container">
        <button class="tab-btn active" data-tab="dashboard" data-target="#dashboard">
            <i class="fas fa-chart-line"></i> Dashboard
        </button>
        <button class="tab-btn" data-tab="tree" data-target="#tree">
            <i class="fas fa-sitemap"></i> C√¢y Gia Ph·∫£
        </button>
        <button class="tab-btn" data-tab="members" data-target="#members">
            <i class="fas fa-users"></i> Danh S√°ch Th√†nh Vi√™n
        </button>
        <button class="tab-btn" data-tab="settings" data-target="#settings">
            <i class="fas fa-cog"></i> C√†i ƒê·∫∑t
        </button>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-content">
        <!-- DASHBOARD TAB -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f97316, #fbbf24);">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3>T·ªïng Th√†nh Vi√™n</h3>
                        <div class="stat-number" id="totalMembers">0</div>
                        <span class="stat-change positive">Ng∆∞·ªùi</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #06b6d4, #0ea5e9);">
                        <i class="fas fa-male"></i>
                    </div>
                    <div class="stat-info">
                        <h3>Nam</h3>
                        <div class="stat-number" id="maleCount">0</div>
                        <span class="stat-change positive" id="malePercent">none</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #ec4899, #f43f5e);">
                        <i class="fas fa-female"></i>
                    </div>
                    <div class="stat-info">
                        <h3>N·ªØ</h3>
                        <div class="stat-number" id="femaleCount">0</div>
                        <span class="stat-change positive" id="femalePercent">none</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #34d399);">
                        <i class="fas fa-layer-group"></i>
                    </div>
                    <div class="stat-info">
                        <h3>Th·∫ø H·ªá</h3>
                        <div class="stat-number" id="generationCount">0</div>
                        <span class="stat-change positive">ƒê·ªùi</span>
                    </div>
                </div>
            </div>

            <!-- GENERATION CHART -->
            <div class="tree-section">
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px; font-size: 18px;">
                    <i class="fas fa-chart-bar" style="color: var(--primary);"></i> Ph√¢n B·ªë Th·∫ø H·ªá
                </h3>
                <div id="generationChart"></div>
            </div>

            <!-- BIRTHDAYS & ACTIVITIES -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 30px;">
                <div class="tree-section">
                    <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px; font-size: 18px;">
                        <i class="fas fa-birthday-cake" style="color: var(--primary);"></i> Sinh Nh·∫≠t S·∫Øp T·ªõi
                    </h3>
                    <div id="birthdayList" style="display: flex; flex-direction: column; gap: 12px;"></div>
                </div>

                <div class="tree-section">
                    <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px; font-size: 18px;">
                        <i class="fas fa-history" style="color: var(--primary);"></i> Ho·∫°t ƒê·ªông G·∫ßn ƒê√¢y
                    </h3>
                    <div id="activityList" style="display: flex; flex-direction: column; gap: 12px;"></div>
                </div>
            </div>
        </div>

        <!-- FAMILY TREE TAB -->
        <div id="tree" class="tab-content">
            <div class="tree-section">
                <div class="tree-controls">
                    <button class="btn-control" onclick="zoomIn()">
                        <i class="fas fa-search-plus"></i> Ph√≥ng To
                    </button>
                    <button class="btn-control" onclick="zoomOut()">
                        <i class="fas fa-search-minus"></i> Thu Nh·ªè
                    </button>
                    <button class="btn-control" onclick="resetZoom()">
                        <i class="fas fa-redo"></i> ƒê·∫∑t L·∫°i
                    </button>
                    <button class="btn-control" onclick="downloadTree()">
                        <i class="fas fa-download"></i> T·∫£i Xu·ªëng
                    </button>
                </div>
                <svg id="familyTreeSvg" style="width: 100%; height: auto; min-height: 600px; border: 2px solid #fed7aa; border-radius: 16px; background: #fffbf0;"></svg>
            </div>
        </div>

        <!-- MEMBERS TAB -->
        <div id="members" class="tab-content">
            <div class="tree-section">
                <div class="members-header">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm th√†nh vi√™n...">
                    </div>
                    <button class="btn-add" onclick="openAdvancedSearch()" style="background: linear-gradient(135deg, #06b6d4, #0ea5e9);">
                        <i class="fas fa-filter"></i> T√¨m N√¢ng Cao
                    </button>
                    <button class="btn-add" onclick="openAddMemberModal()">
                        <i class="fas fa-plus"></i> Th√™m Th√†nh Vi√™n
                    </button>
                </div>
                <div class="members-grid" id="membersGrid"></div>
            </div>
        </div>

        <!-- SETTINGS TAB -->
        <div id="settings" class="tab-content">
            <div class="tree-section">
                <h2 style="margin-bottom: 24px; font-size: 20px;">‚öôÔ∏è C√†i ƒê·∫∑t & C√¥ng C·ª•</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                    <div class="settings-card" onclick="exportPDF()">
                        <i class="fas fa-file-pdf"></i>
                        <h3>üì• Xu·∫•t PDF</h3>
                        <p>Xu·∫•t gia ph·∫£ d∆∞·ªõi d·∫°ng PDF</p>
                    </div>
                    <div class="settings-card" onclick="importData()">
                        <i class="fas fa-file-csv"></i>
                        <h3>üì§ Nh·∫≠p D·ªØ Li·ªáu</h3>
                        <p>Nh·∫≠p d·ªØ li·ªáu t·ª´ file CSV</p>
                    </div>
                    <div class="settings-card" onclick="resetData()">
                        <i class="fas fa-redo"></i>
                        <h3>üìÑ Kh√¥i Ph·ª•c M·∫´u</h3>
                        <p>Kh√¥i ph·ª•c d·ªØ li·ªáu m·∫´u m·∫∑c ƒë·ªãnh</p>
                    </div>
                    <div id="adminPanel"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- MEMBER DETAIL MODAL -->
    <div id="memberModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Th√¥ng Tin Th√†nh Vi√™n</h2>
                <button class="close-btn" onclick="closeMemberModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="memberDetailContent"></div>
        </div>
    </div>

    <!-- ADD/EDIT MEMBER MODAL -->
    <div id="addMemberModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="addModalTitle">Th√™m Th√†nh Vi√™n</h2>
                <button class="close-btn" onclick="closeAddMemberModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="memberForm" style="display: flex; flex-direction: column; gap: 16px;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>H·ªç v√† T√™n *</label>
                            <input type="text" id="memberName" required>
                        </div>
                        <div class="form-group">
                            <label>Gi·ªõi T√≠nh</label>
                            <select id="memberGender">
                                <option value="male">Nam</option>
                                <option value="female">N·ªØ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Ng√†y Sinh *</label>
                            <input type="date" id="memberBirth" required>
                        </div>
                        <div class="form-group">
                            <label>Ng√†y M·∫•t</label>
                            <input type="date" id="memberDeath">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë ƒêi·ªán Tho·∫°i</label>
                            <input type="tel" id="memberPhone" placeholder="0912345678">
                        </div>
                        <div class="form-group">
                            <label>Th·∫ø H·ªá</label>
                            <select id="memberGeneration">
                                <option value="1">Th·∫ø h·ªá 1</option>
                                <option value="2">Th·∫ø h·ªá 2</option>
                                <option value="3">Th·∫ø h·ªá 3</option>
                                <option value="4">Th·∫ø h·ªá 4</option>
                                <option value="5">Th·∫ø h·ªá 5</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Ngh·ªÅ Nghi·ªáp</label>
                            <input type="text" id="memberJob" placeholder="V√≠ d·ª•: Gi√°o vi√™n">
                        </div>
                        <div class="form-group">
                            <label>ƒê·ªãa Ch·ªâ</label>
                            <input type="text" id="memberAddress" placeholder="V√≠ d·ª•: H√† N·ªôi">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Ghi Ch√∫ / M·ªëi Quan H·ªá</label>
                        <textarea id="memberNote" placeholder="V√≠ d·ª•: √îng ngo√†i, B√†, v.v."></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Cha/M·∫π</label>
                            <select id="memberParent">
                                <option value="">-- Kh√¥ng c√≥ --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>V·ª£/Ch·ªìng</label>
                            <select id="memberSpouse">
                                <option value="">-- Kh√¥ng c√≥ --</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-cancel" onclick="closeAddMemberModal()">H·ªßy</button>
                        <button type="submit" class="btn-save">L∆∞u Th√†nh Vi√™n</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ADVANCED SEARCH MODAL -->
    <div id="advancedSearchModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>üîç T√¨m Ki·∫øm N√¢ng Cao</h2>
                <button class="close-btn" onclick="closeAdvancedSearch()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="advancedSearchForm" style="display: flex; flex-direction: column; gap: 16px;">
                    <div class="form-group">
                        <label>H·ªç v√† T√™n</label>
                        <input type="text" id="searchName" placeholder="Nh·∫≠p t√™n th√†nh vi√™n...">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Th·∫ø H·ªá</label>
                            <select id="searchGeneration">
                                <option value="">-- T·∫•t c·∫£ --</option>
                                <option value="1">Th·∫ø h·ªá 1</option>
                                <option value="2">Th·∫ø h·ªá 2</option>
                                <option value="3">Th·∫ø h·ªá 3</option>
                                <option value="4">Th·∫ø h·ªá 4</option>
                                <option value="5">Th·∫ø h·ªá 5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Gi·ªõi T√≠nh</label>
                            <select id="searchGender">
                                <option value="all">-- T·∫•t c·∫£ --</option>
                                <option value="male">Nam</option>
                                <option value="female">N·ªØ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Tr·∫°ng Th√°i</label>
                            <select id="searchStatus">
                                <option value="">-- T·∫•t c·∫£ --</option>
                                <option value="living">ƒêang s·ªëng</option>
                                <option value="deceased">Qu√° c·ªë</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ngh·ªÅ Nghi·ªáp</label>
                            <input type="text" id="searchJob" placeholder="V√≠ d·ª•: Gi√°o vi√™n">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Tu·ªïi t·ª´</label>
                            <input type="number" id="searchAgeMin" placeholder="Tu·ªïi t·ªëi thi·ªÉu" min="0" max="150">
                        </div>
                        <div class="form-group">
                            <label>Tu·ªïi ƒë·∫øn</label>
                            <input type="number" id="searchAgeMax" placeholder="Tu·ªïi t·ªëi ƒëa" min="0" max="150">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ƒê·ªãa Ch·ªâ</label>
                        <input type="text" id="searchAddress" placeholder="V√≠ d·ª•: H√† N·ªôi">
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-cancel" onclick="resetAdvancedSearch()">ƒê·∫∑t L·∫°i</button>
                        <button type="button" class="btn-save" onclick="performAdvancedSearch()">T√¨m Ki·∫øm</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../components/dashboard.js"></script>
    <!-- <script src="familyTreeRenderer.js" defer></script>
    <script src="dashboard.js" defer></script> -->
</body>
</html>